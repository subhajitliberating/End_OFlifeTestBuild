import{r as E}from"./react-CNM1HoWL.js";import{p as e}from"./prop-types-DQw5ku1y.js";var k=function(){return k=Object.assign||function(r){for(var t,i=1,a=arguments.length;i<a;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},k.apply(this,arguments)},M={onActivate:e.func,onAddUndo:e.func,onBeforeAddUndo:e.func,onBeforeExecCommand:e.func,onBeforeGetContent:e.func,onBeforeRenderUI:e.func,onBeforeSetContent:e.func,onBeforePaste:e.func,onBlur:e.func,onChange:e.func,onClearUndos:e.func,onClick:e.func,onContextMenu:e.func,onCommentChange:e.func,onCompositionEnd:e.func,onCompositionStart:e.func,onCompositionUpdate:e.func,onCopy:e.func,onCut:e.func,onDblclick:e.func,onDeactivate:e.func,onDirty:e.func,onDrag:e.func,onDragDrop:e.func,onDragEnd:e.func,onDragGesture:e.func,onDragOver:e.func,onDrop:e.func,onExecCommand:e.func,onFocus:e.func,onFocusIn:e.func,onFocusOut:e.func,onGetContent:e.func,onHide:e.func,onInit:e.func,onInput:e.func,onKeyDown:e.func,onKeyPress:e.func,onKeyUp:e.func,onLoadContent:e.func,onMouseDown:e.func,onMouseEnter:e.func,onMouseLeave:e.func,onMouseMove:e.func,onMouseOut:e.func,onMouseOver:e.func,onMouseUp:e.func,onNodeChange:e.func,onObjectResizeStart:e.func,onObjectResized:e.func,onObjectSelected:e.func,onPaste:e.func,onPostProcess:e.func,onPostRender:e.func,onPreProcess:e.func,onProgressState:e.func,onRedo:e.func,onRemove:e.func,onReset:e.func,onSaveContent:e.func,onSelectionChange:e.func,onSetAttrib:e.func,onSetContent:e.func,onShow:e.func,onSubmit:e.func,onUndo:e.func,onVisualAid:e.func,onSkinLoadError:e.func,onThemeLoadError:e.func,onModelLoadError:e.func,onPluginLoadError:e.func,onIconsLoadError:e.func,onLanguageLoadError:e.func,onScriptsLoad:e.func,onScriptsLoadError:e.func},N=k({apiKey:e.string,licenseKey:e.string,id:e.string,inline:e.bool,init:e.object,initialValue:e.string,onEditorChange:e.func,value:e.string,tagName:e.string,tabIndex:e.number,cloudChannel:e.string,plugins:e.oneOfType([e.string,e.array]),toolbar:e.oneOfType([e.string,e.array]),disabled:e.bool,textareaName:e.string,tinymceScriptSrc:e.oneOfType([e.string,e.arrayOf(e.string),e.arrayOf(e.shape({src:e.string,async:e.bool,defer:e.bool}))]),rollback:e.oneOfType([e.number,e.oneOf([!1])]),scriptLoading:e.shape({async:e.bool,defer:e.bool,delay:e.number})},M),S=function(r){return typeof r=="function"},L=function(r){return r in M},O=function(r){return r.substr(2)},R=function(r,t,i,a,o,s,n){var u=Object.keys(o).filter(L),c=Object.keys(s).filter(L),f=u.filter(function(d){return s[d]===void 0}),l=c.filter(function(d){return o[d]===void 0});f.forEach(function(d){var p=O(d),v=n[p];i(p,v),delete n[p]}),l.forEach(function(d){var p=a(r,d),v=O(d);n[v]=p,t(v,p)})},x=function(r,t,i,a,o){return R(o,r.on.bind(r),r.off.bind(r),function(s,n){return function(u){var c;return(c=s(n))===null||c===void 0?void 0:c(u,r)}},t,i,a)},D=0,P=function(r){var t=Date.now(),i=Math.floor(Math.random()*1e9);return D++,r+"_"+i+D+String(t)},T=function(r){return r!==null&&(r.tagName.toLowerCase()==="textarea"||r.tagName.toLowerCase()==="input")},B=function(r){return typeof r>"u"||r===""?[]:Array.isArray(r)?r:r.split(" ")},A=function(r,t){return B(r).concat(B(t))},H=function(){return window.InputEvent&&typeof InputEvent.prototype.getTargetRanges=="function"},K=function(r){if(!("isConnected"in Node.prototype)){for(var t=r,i=r.parentNode;i!=null;)t=i,i=t.parentNode;return t===r.ownerDocument}return r.isConnected},j=function(r,t){r!==void 0&&(r.mode!=null&&typeof r.mode=="object"&&typeof r.mode.set=="function"?r.mode.set(t):r.setMode(t))},w=function(){return w=Object.assign||function(r){for(var t,i=1,a=arguments.length;i<a;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},w.apply(this,arguments)},V=function(r,t,i){var a,o,s=r.createElement("script");s.referrerPolicy="origin",s.type="application/javascript",s.id=t.id,s.src=t.src,s.async=(a=t.async)!==null&&a!==void 0?a:!1,s.defer=(o=t.defer)!==null&&o!==void 0?o:!1;var n=function(){s.removeEventListener("load",n),s.removeEventListener("error",u),i(t.src)},u=function(c){s.removeEventListener("load",n),s.removeEventListener("error",u),i(t.src,c)};s.addEventListener("load",n),s.addEventListener("error",u),r.head&&r.head.appendChild(s)},U=function(r){var t={},i=function(n,u){var c=t[n];c.done=!0,c.error=u;for(var f=0,l=c.handlers;f<l.length;f++){var d=l[f];d(n,u)}c.handlers=[]},a=function(n,u,c){var f=function(C){return c!==void 0?c(C):console.error(C)};if(n.length===0){f(new Error("At least one script must be provided"));return}for(var l=0,d=!1,p=function(C,I){d||(I?(d=!0,f(I)):++l===n.length&&u())},v=0,h=n;v<h.length;v++){var y=h[v],g=t[y.src];if(g)g.done?p(y.src,g.error):g.handlers.push(p);else{var m=P("tiny-");t[y.src]={id:m,src:y.src,done:!1,error:null,handlers:[p]},V(r,w({id:m},y),i)}}},o=function(){for(var n,u=0,c=Object.values(t);u<c.length;u++){var f=c[u],l=r.getElementById(f.id);l!=null&&l.tagName==="SCRIPT"&&((n=l.parentNode)===null||n===void 0||n.removeChild(l))}t={}},s=function(){return r};return{loadScripts:a,deleteScripts:o,getDocument:s}},F=function(){var r=[],t=function(o){var s=r.find(function(n){return n.getDocument()===o});return s===void 0&&(s=U(o),r.push(s)),s},i=function(o,s,n,u,c){var f=function(){return t(o).loadScripts(s,u,c)};n>0?setTimeout(f,n):f()},a=function(){for(var o=r.pop();o!=null;o=r.pop())o.deleteScripts()};return{loadList:i,reinitialize:a}},z=F(),_=function(r){var t=r;return t&&t.tinymce?t.tinymce:null},G=function(){var r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(a[s]=o[s])},r(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");r(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),b=function(){return b=Object.assign||function(r){for(var t,i=1,a=arguments.length;i<a;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},b.apply(this,arguments)},J=function(r){G(t,r);function t(i){var a,o,s,n=r.call(this,i)||this;return n.rollbackTimer=void 0,n.valueCursor=void 0,n.rollbackChange=function(){var u=n.editor,c=n.props.value;u&&c&&c!==n.currentContent&&u.undoManager.ignore(function(){if(u.setContent(c),n.valueCursor&&(!n.inline||u.hasFocus()))try{u.selection.moveToBookmark(n.valueCursor)}catch{}}),n.rollbackTimer=void 0},n.handleBeforeInput=function(u){if(n.props.value!==void 0&&n.props.value===n.currentContent&&n.editor&&(!n.inline||n.editor.hasFocus()))try{n.valueCursor=n.editor.selection.getBookmark(3)}catch{}},n.handleBeforeInputSpecial=function(u){(u.key==="Enter"||u.key==="Backspace"||u.key==="Delete")&&n.handleBeforeInput(u)},n.handleEditorChange=function(u){var c=n.editor;if(c&&c.initialized){var f=c.getContent();n.props.value!==void 0&&n.props.value!==f&&n.props.rollback!==!1&&(n.rollbackTimer||(n.rollbackTimer=window.setTimeout(n.rollbackChange,typeof n.props.rollback=="number"?n.props.rollback:200))),f!==n.currentContent&&(n.currentContent=f,S(n.props.onEditorChange)&&n.props.onEditorChange(f,c))}},n.handleEditorChangeSpecial=function(u){(u.key==="Backspace"||u.key==="Delete")&&n.handleEditorChange(u)},n.initialise=function(u){var c,f,l;u===void 0&&(u=0);var d=n.elementRef.current;if(d){if(!K(d)){if(u===0)setTimeout(function(){return n.initialise(1)},1);else if(u<100)setTimeout(function(){return n.initialise(u+1)},100);else throw new Error("tinymce can only be initialised when in a document");return}var p=_(n.view);if(!p)throw new Error("tinymce should have been loaded into global scope");var v=b(b(b(b({},n.props.init),{selector:void 0,target:d,readonly:n.props.disabled,inline:n.inline,plugins:A((c=n.props.init)===null||c===void 0?void 0:c.plugins,n.props.plugins),toolbar:(f=n.props.toolbar)!==null&&f!==void 0?f:(l=n.props.init)===null||l===void 0?void 0:l.toolbar}),n.props.licenseKey?{license_key:n.props.licenseKey}:{}),{setup:function(h){n.editor=h,n.bindHandlers({}),n.inline&&!T(d)&&h.once("PostRender",function(y){h.setContent(n.getInitialValue(),{no_events:!0})}),n.props.init&&S(n.props.init.setup)&&n.props.init.setup(h)},init_instance_callback:function(h){var y,g,m=n.getInitialValue();n.currentContent=(y=n.currentContent)!==null&&y!==void 0?y:h.getContent(),n.currentContent!==m&&(n.currentContent=m,h.setContent(m),h.undoManager.clear(),h.undoManager.add(),h.setDirty(!1));var C=(g=n.props.disabled)!==null&&g!==void 0?g:!1;j(n.editor,C?"readonly":"design"),n.props.init&&S(n.props.init.init_instance_callback)&&n.props.init.init_instance_callback(h)}});n.inline||(d.style.visibility=""),T(d)&&(d.value=n.getInitialValue()),p.init(v)}},n.id=n.props.id||P("tiny-react"),n.elementRef=E.createRef(),n.inline=(s=(a=n.props.inline)!==null&&a!==void 0?a:(o=n.props.init)===null||o===void 0?void 0:o.inline)!==null&&s!==void 0?s:!1,n.boundHandlers={},n}return Object.defineProperty(t.prototype,"view",{get:function(){var i,a;return(a=(i=this.elementRef.current)===null||i===void 0?void 0:i.ownerDocument.defaultView)!==null&&a!==void 0?a:window},enumerable:!1,configurable:!0}),t.prototype.componentDidUpdate=function(i){var a=this,o,s;if(this.rollbackTimer&&(clearTimeout(this.rollbackTimer),this.rollbackTimer=void 0),this.editor&&(this.bindHandlers(i),this.editor.initialized)){if(this.currentContent=(o=this.currentContent)!==null&&o!==void 0?o:this.editor.getContent(),typeof this.props.initialValue=="string"&&this.props.initialValue!==i.initialValue)this.editor.setContent(this.props.initialValue),this.editor.undoManager.clear(),this.editor.undoManager.add(),this.editor.setDirty(!1);else if(typeof this.props.value=="string"&&this.props.value!==this.currentContent){var n=this.editor;n.undoManager.transact(function(){var c;if(!a.inline||n.hasFocus())try{c=n.selection.getBookmark(3)}catch{}var f=a.valueCursor;if(n.setContent(a.props.value),!a.inline||n.hasFocus())for(var l=0,d=[c,f];l<d.length;l++){var p=d[l];if(p)try{n.selection.moveToBookmark(p),a.valueCursor=p;break}catch{}}})}if(this.props.disabled!==i.disabled){var u=(s=this.props.disabled)!==null&&s!==void 0?s:!1;j(this.editor,u?"readonly":"design")}}},t.prototype.componentDidMount=function(){var i=this,a,o,s,n,u;if(_(this.view)!==null)this.initialise();else if(Array.isArray(this.props.tinymceScriptSrc)&&this.props.tinymceScriptSrc.length===0)(o=(a=this.props).onScriptsLoadError)===null||o===void 0||o.call(a,new Error("No `tinymce` global is present but the `tinymceScriptSrc` prop was an empty array."));else if(!((s=this.elementRef.current)===null||s===void 0)&&s.ownerDocument){var c=function(){var l,d;(d=(l=i.props).onScriptsLoad)===null||d===void 0||d.call(l),i.initialise()},f=function(l){var d,p;(p=(d=i.props).onScriptsLoadError)===null||p===void 0||p.call(d,l)};z.loadList(this.elementRef.current.ownerDocument,this.getScriptSources(),(u=(n=this.props.scriptLoading)===null||n===void 0?void 0:n.delay)!==null&&u!==void 0?u:0,c,f)}},t.prototype.componentWillUnmount=function(){var i=this,a=this.editor;a&&(a.off(this.changeEvents(),this.handleEditorChange),a.off(this.beforeInputEvent(),this.handleBeforeInput),a.off("keypress",this.handleEditorChangeSpecial),a.off("keydown",this.handleBeforeInputSpecial),a.off("NewBlock",this.handleEditorChange),Object.keys(this.boundHandlers).forEach(function(o){a.off(o,i.boundHandlers[o])}),this.boundHandlers={},a.remove(),this.editor=void 0)},t.prototype.render=function(){return this.inline?this.renderInline():this.renderIframe()},t.prototype.changeEvents=function(){var i,a,o,s=(o=(a=(i=_(this.view))===null||i===void 0?void 0:i.Env)===null||a===void 0?void 0:a.browser)===null||o===void 0?void 0:o.isIE();return s?"change keyup compositionend setcontent CommentChange":"change input compositionend setcontent CommentChange"},t.prototype.beforeInputEvent=function(){return H()?"beforeinput SelectionChange":"SelectionChange"},t.prototype.renderInline=function(){var i=this.props.tagName,a=i===void 0?"div":i;return E.createElement(a,{ref:this.elementRef,id:this.id,tabIndex:this.props.tabIndex})},t.prototype.renderIframe=function(){return E.createElement("textarea",{ref:this.elementRef,style:{visibility:"hidden"},name:this.props.textareaName,id:this.id,tabIndex:this.props.tabIndex})},t.prototype.getScriptSources=function(){var i,a,o=(i=this.props.scriptLoading)===null||i===void 0?void 0:i.async,s=(a=this.props.scriptLoading)===null||a===void 0?void 0:a.defer;if(this.props.tinymceScriptSrc!==void 0)return typeof this.props.tinymceScriptSrc=="string"?[{src:this.props.tinymceScriptSrc,async:o,defer:s}]:this.props.tinymceScriptSrc.map(function(f){return typeof f=="string"?{src:f,async:o,defer:s}:f});var n=this.props.cloudChannel,u=this.props.apiKey?this.props.apiKey:"no-api-key",c="https://cdn.tiny.cloud/1/".concat(u,"/tinymce/").concat(n,"/tinymce.min.js");return[{src:c,async:o,defer:s}]},t.prototype.getInitialValue=function(){return typeof this.props.initialValue=="string"?this.props.initialValue:typeof this.props.value=="string"?this.props.value:""},t.prototype.bindHandlers=function(i){var a=this;if(this.editor!==void 0){x(this.editor,i,this.props,this.boundHandlers,function(u){return a.props[u]});var o=function(u){return u.onEditorChange!==void 0||u.value!==void 0},s=o(i),n=o(this.props);!s&&n?(this.editor.on(this.changeEvents(),this.handleEditorChange),this.editor.on(this.beforeInputEvent(),this.handleBeforeInput),this.editor.on("keydown",this.handleBeforeInputSpecial),this.editor.on("keyup",this.handleEditorChangeSpecial),this.editor.on("NewBlock",this.handleEditorChange)):s&&!n&&(this.editor.off(this.changeEvents(),this.handleEditorChange),this.editor.off(this.beforeInputEvent(),this.handleBeforeInput),this.editor.off("keydown",this.handleBeforeInputSpecial),this.editor.off("keyup",this.handleEditorChangeSpecial),this.editor.off("NewBlock",this.handleEditorChange))}},t.propTypes=N,t.defaultProps={cloudChannel:"7"},t}(E.Component);export{J as E};
